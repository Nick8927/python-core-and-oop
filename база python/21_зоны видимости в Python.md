# Область видимости переменных в Python

## Базовая теория

Область видимости (scope) — это часть программы, где переменная «видна» и доступна для использования.  
Python использует модель **LEGB** — порядок поиска переменных:

1. **Local** — локальная область (внутри текущей функции).
2. **Enclosing** — область замыканий (переменные внешних, но не глобальных функций).
3. **Global** — глобальная область (внутри модуля, вне функций).
4. **Built-in** — встроенные имена Python (например, `len`, `print`, `range`).

---

## 1. Глобальная область видимости (Global Scope)

Переменные, объявленные вне функций, доступны по всему модулю.

```python
number1 = 100

def my_func(lst_new):
    print(number1)  # доступ к глобальной переменной
    for x in lst_new:
        res = x + 1
        print(res)
```

Если внутри функции создать переменную с тем же именем, глобальная не изменится:

```python
number1 = 100

def my_func(lst_new):
    number1 = 101  # локальная переменная
    print(number1)  # 101 внутри функции
    for x in lst_new:
        res = x + 1
        print(res)

my_func([1, 2])
print(number1)  # 100 (глобальная не изменилась)
```

---

## 2. Локальная область видимости (Local Scope)

Переменные, объявленные внутри функции, видимы только в её пределах.

```python
def my_func(lst_new):
    for x in lst_new:
        res = x + 1
        print(res)

print(res)  # NameError: res не определён
```

---

## 3. Область видимости замыканий (Enclosing Scope)

Если функция вложена в другую, она может видеть переменные внешней функции:

```python
def outer():
    num = 1

    def inner():
        print(num)  # доступ к enclosing-переменной

    inner()

outer()
```

Для изменения значения переменной во внешней функции используют `nonlocal`:

```python
num = 0

def outer():
    num = 1

    def inner():
        nonlocal num
        num = 2
        print("inner:", num)

    inner()
    print("outer:", num)

outer()
print("global:", num)
```

> ⚠️ `nonlocal` работает **только с переменными из enclosing scope**, а не с глобальными.

---

## 4. Ключевое слово `global`

Чтобы изменить глобальную переменную внутри функции:

```python
number1 = 100

def my_func(lst_new):
    global number1  # объявляем, что хотим использовать глобальную
    number1 = 200
    for x in lst_new:
        res = x + number1
        print(res)

my_func([1, 2])
print(number1)  # 200
```

> ⚠️ `global` должно быть объявлено **до** изменения переменной в теле функции.

---

## 5. Важно помнить

- Лучше избегать глобальных переменных: они делают код менее предсказуемым.
- Используй `return`, чтобы вернуть значение из функции вместо изменения глобальных переменных.
- `nonlocal` и `global` применять осознанно — для сложных случаев вложенных функций.

---

## Вопросы для собеседования 

**1. Что такое область видимости переменной?**  
**Ответ:** Это часть программы, в которой можно обращаться к переменной по её имени.

**2. Какие области видимости существуют в Python?**  
**Ответ:** Локальная (Local), замыкания (Enclosing), глобальная (Global) и встроенная (Built-in).

**3. Что делает ключевое слово `global`?**  
**Ответ:** Позволяет функции изменять значение переменной, объявленной на глобальном уровне.

**4. Что делает ключевое слово `nonlocal`?**  
**Ответ:** Позволяет изменять переменную, объявленную во внешней (но не глобальной) функции.

**5. Можно ли из функции изменить глобальную переменную без `global`?**  
**Ответ:** Нет, без `global` можно только читать значение, но не изменять.

**6. Что произойдёт, если внутри функции объявить переменную с тем же именем, что и глобальная?**  
**Ответ:** Она станет локальной, и глобальная переменная не изменится.

**7. Можно ли использовать `nonlocal` для глобальных переменных?**  
**Ответ:** Нет, `nonlocal` работает только с переменными из замыканий (enclosing scope).

**8. Что произойдёт, если внутри функции обратиться к переменной, не объявленной в ней?**  
**Ответ:** Python будет искать её по цепочке областей видимости (LEGB: Local → Enclosing → Global → Built-in).

**9. Что означает аббревиатура LEGB?**  
**Ответ:** Local, Enclosing, Global, Built-in — порядок поиска переменных.

**10. Зачем нужно избегать чрезмерного использования `global` и `nonlocal`?**  
**Ответ:** Это ухудшает читаемость и может вызвать ошибки при изменении состояния программы.

---

